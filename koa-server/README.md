
后端的路由就是前端的接口地址

前端axios.get('/').then(res => {}) 中的res实际上是ctx.body的内容

ctx.body


/

管理系统
/manage


前台页面
/ web


body-parse 用于获得 ctx.request.body   => 返回请求体（返回给前端的数据）



【注册逻辑】 - 用户和密码接收后：
- 校验username 和 password （请求体携带参数的字段名是否正确）
    - 字段正常，下一步
    - 字段有错，返回消息（用户名、密码错误）

- 查询数据库是否有username
    - 已经存在该用户，则返回消息（请勿重复注册）
    - 不存在该用户，下一步

- 赋予用户名 密码 默认头像
    - 默认头像生成
    - 返回注册成功给前端



【规范返回信息结构】
{
    errCode: 0,
    msg: '注册成功',
    data: {}
}


【登录逻辑】 - 用户和密码接收后：
- 校验username 和 password （请求体携带参数的字段名是否正确）
    - 字段正常，下一步
    - 字段有错，返回消息（用户名、密码错误）

- 查询数据库中有没有这个username
    - 已经存在该用户，下一步
    - 不存在该用户，返回消息（请先注册）

- 把生成的token 存入user表，并查询对应用户的相关信息返回给前端


【获取用户信息逻辑】
- 1. 前端传送token
    鉴权（鉴别token） （除了登录注册外，所有接口都要鉴权）
        - token 生效，进行步骤2
        - token 没生效， 即 token过期（1h）或 没这个用户， 则 让前端提醒用户重新登录
- 2. 从数据库检索该用户的所有信息
    根据token从数据库中读取用户，并返回对应的信息给前端


【修改用户信息逻辑】
- 1. 前端传username password token
     - 后端进行鉴权
     - 后端进行校验字段，鉴权成功跳转步骤2
- 2. 更新修改数据库中的用户名或密码


【图片上传逻辑】
- 1. 前后端要协约好图片的字段 - avatar
- 2. 后端逻辑
    2.1 鉴权
    2.2 接收到前端传过来的图片
        - 判断图片是否超过大小限制20kb
        - 设置单图上传
        - 修改图片名字（aaa-时间戳.jpg） - 使用时间戳让图片的名字唯一
        - 存储前端传过来的图片
        - 读取这个文件的路径，存入数据库替换avatar字段的值
        - 读取数据库的整体用户信息，返回给前端
- 3. 前端逻辑
    3.1 调用组件
    3.2 设置请求的地址和token
    3.3 修改localStorage，更新header组件 key context


【用户角色权限】 role
- 1. 管理员
    - 可以给普通用户增加编辑权限
- 2. 普通用户


【编辑权限】 editable
- 管理员可以编辑
- 普通用户需要等管理员赋予权限才可编辑

登录成功需要返回 role和editable字段

> editable 表示是否可以编辑文章， 0 表示不允许编辑文章， 1 表示可以编辑文章

> role 表示是否为管理员， normal表示普通用户 ； vip表示管理员


【文章编辑逻辑】
- 0. 鉴权
- 1. 前端传文章的id过来
- 2. 到数据库中查找对应id的文章
- 3. title subTitle content date author字段全该


